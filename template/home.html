<!DOCTYPE html>
<html lang="en" class="scroll-smooth">

<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://kit.fontawesome.com/258973f2c5.js" crossorigin="anonymous"></script>
    <title>Talk to pdf</title>

    <style>
        .overflow-x-scroll::-webkit-scrollbar {
            display: none;
        }
    </style>
</head>

<body class="bg-gradient-to-r from-gray-800 via-gray-700 to-gray-600">

    <nav class="bg-opacity-25 bg-white backdrop-filter backdrop-blur-lg fixed top-0 w-full z-50">
        <div class="container mx-auto px-6 py-3 flex justify-between items-center">
            <div>
                <a href="#" class="text-gray-200 font-semibold text-lg md:text-xl hover:text-gray-300">
                    Home
                </a>
            </div>
            <div class="flex space-x-4">
                <a href="#dp-box" class="font-semibold text-gray-100 hover:text-gray-300">
                    Upload Book
                </a>
                <a href="#" class="font-semibold text-gray-100 hover:text-gray-300">
                    About
                </a>
                <a href="#" class="font-semibold text-gray-100 hover:text-gray-300">
                    Profile
                </a>
            </div>
        </div>
    </nav>

    <div class="px-28 py-20 flex flex-col items-center justify-center text-center">

        <div class="container mx-auto py-8 flex flex-col justify-center items-center">
            <h2 class="text-3xl p-5 font-semibold font-mono mb-4 text-white">My Bookshelf</h2>
            <div class="flex overflow-x-scroll w-[80%]">
                <div
                    class="flex-none w-48 rounded-lg bg-gray-100 shadow-lg p-4 mr-4 shelf-box hover:scale-105 transition-transform duration-300 hover:bg-gradient-to-r from-gray-400 via-gray-300 to-gray-200">
                    <a href="#" class="block">
                        <img src="/static/img/bengali.jpg" alt="Bengali" class="w-44 h-48 object-cover mb-2">
                        <h3 class="text-base font-mono font-semibold">Bangla Book</h3>
                    </a>
                </div>
                <div onclick="readBookOnSelect(this)" data-bookname="chemistry"
                    class="flex-none w-48 rounded-lg bg-gray-100 shadow-lg p-4 mr-4 shelf-box hover:scale-105 transition-transform duration-300 hover:bg-gradient-to-r from-gray-400 via-gray-300 to-gray-200">
                    <a href="#" class="block">
                        <img src="/static/img/chemistry.jpg" alt="chemistry" class="w-44 h-48 object-cover mb-2">
                        <h3 class="text-base font-mono font-semibold">Chemistry</h3>
                    </a>
                </div>
                <div onclick="readBookOnSelect(this)" data-bookname="physics"
                    class="flex-none w-48 rounded-lg bg-gray-100 shadow-lg p-4 mr-4 shelf-box hover:scale-105 transition-transform duration-300 hover:bg-gradient-to-r from-gray-400 via-gray-300 to-gray-200">
                    <a href="#" class="block">
                        <img src="/static/img/physics.jpg" alt="physics" class="w-44 h-48 object-cover mb-2">
                        <h3 class="text-base font-mono font-semibold">Physics</h3>
                    </a>
                </div>
                <div
                    class="flex-none w-48 rounded-lg bg-gray-100 shadow-lg p-4 mr-4 shelf-box hover:scale-105 transition-transform duration-300 hover:bg-gradient-to-r from-gray-400 via-gray-300 to-gray-200">
                    <a href="#" class="block">
                        <img src="/static/img/english.jpg" alt="english" class="w-44 h-48 object-cover mb-2">
                        <h3 class="text-base font-mono font-semibold">English</h3>
                    </a>
                </div>
                <div onclick="readBookOnSelect(this)" data-bookname="math"
                    class="flex-none w-48 rounded-lg bg-gray-100 shadow-lg p-4 mr-4 shelf-box hover:scale-105 transition-transform duration-300 hover:bg-gradient-to-r from-gray-400 via-gray-300 to-gray-200">
                    <a href="#" class="block">
                        <img src="/static/img/maths.jpg" alt="maths" class="w-44 h-48 object-cover mb-2">
                        <h3 class="text-base font-mono font-semibold">Mathematics</h3>
                    </a>
                </div>
                <div onclick="readBookOnSelect(this)" data-bookname="math"
                    class="flex-none w-48 rounded-lg bg-gray-100 shadow-lg p-4 mr-4 shelf-box hover:scale-105 transition-transform duration-300 hover:bg-gradient-to-r from-gray-400 via-gray-300 to-gray-200">
                    <a href="#" class="block">
                        <img src="/static/img/maths.jpg" alt="maths" class="w-44 h-48 object-cover mb-2">
                        <h3 class="text-base font-mono font-semibold">Mathematics</h3>
                    </a>
                </div>
                <div onclick="readBookOnSelect(this)" data-bookname="math"
                    class="flex-none w-48 rounded-lg bg-gray-100 shadow-lg p-4 mr-4 shelf-box hover:scale-105 transition-transform duration-300 hover:bg-gradient-to-r from-gray-400 via-gray-300 to-gray-200">
                    <a href="#" class="block">
                        <img src="/static/img/maths.jpg" alt="maths" class="w-44 h-48 object-cover mb-2">
                        <h3 class="text-base font-mono font-semibold">Mathematics</h3>
                    </a>
                </div>
            </div>
        </div>
        <!-- <h1 class="text-4xl font-semibold p-5 text-gray-100">Talk to any PDF</h1> -->

        <!-- <div class="bg-white py-4 sm:py-2">
            <h2 class="font-semibold">Select from pre-loaded books</h2>
            <div class="bg-white p-4">
                <button onclick="readBookOnSelect(this);"
                    class="inline-flex items-center px-4 py-2 bg-gray-300 hover:bg-indigo-400 text-gray-800 text-sm font-medium rounded-md"
                    data-bookname="physics">
                    Physics
                </button>

                <button onclick="readBookOnSelect(this);"
                    class="inline-flex items-center px-4 py-2 bg-gray-300 hover:bg-indigo-400 text-gray-800 text-sm font-medium rounded-md"
                    data-bookname="math">
                    Mathematics
                </button>

                <button onclick="readBookOnSelect(this);"
                    class="inline-flex items-center px-4 py-2 bg-gray-300 hover:bg-indigo-400 text-gray-800 text-sm font-medium rounded-md"
                    data-bookname="chemistry">
                    Chemistry
                </button>
            </div>
        </div> -->

        <!-- <div class="p-3 flex">
            <div
                class="px-2 py-1 m-2 font-mono border-2 border-gray-500 text-gray-50 hover:bg-gradient-to-r from-gray-700 via-gray-600 to-gray-500 cursor-pointer">
                <i class="fa-brands fa-discord"></i>
                <a href="">Join Discord</a>
            </div>
        </div> -->

        <div id="dp-box" class="drop-box w-9/12 h-52 border-2 border-dashed bg-gradient-to-r from-gray-300 via-gray-200 to-gray-100 border-gray-400 flex justify-center items-center text-xl rounded-lg"
            ondrop="handleDrop(event)" ondragover="event.preventDefault()">
            <form method="post" enctype="multipart/form-data"> {% csrf_token %}
                <div class="flex flex-col justify-center items-center">
                    <span class="text-base font-semibold">Drop PDF here &nbsp; <i
                            class="fa-regular fa-file-pdf"></i></span>
                    <input id="pdf_file" type="file" accept="application/pdf" class="file-input mt-4 ml-24 text-lg"
                        onchange="handleFileSelect(event)">
                    <div id="upload-status" class="upload-status mx-4 text-gray-600 font-semibold text-sm py-2"></div>
                </div>
            </form>
        </div>
    </div>

    <div class="px-36 py-10 w-[100%] text-center bg-gradient-to-r from-gray-400 via-gray-300 to-gray-200">
        <h1 class="text-2xl font-semibold text-gray-700 font-mono">Usher into a New Era of Reading</h1>
        <hr class="h-px my-8 bg-gray-200 border-0 dark:bg-gradient-to-r from-gray-600 via-gray-500 to-gray-400">
        <img class=" pr-20" src="/static/img/home.png" alt="content">
    </div>

    <script>

        const room_id = (Math.random() + 1).toString(36).substring(7);

        // For Drag and Drop
        function handleDrop(e) {
            e.preventDefault();
            if (1) {
                const csrfToken = document.getElementsByName('csrfmiddlewaretoken')[0].value;
                let files = e.dataTransfer.files;
                let pdfFile = files[0];
                const formData = new FormData();
                formData.append('csrfmiddlewaretoken', csrfToken);
                formData.append('pdf_file', pdfFile);
                formData.append('room_id', room_id);
                document.getElementById("upload-status").textContent = "File uploaded: " + pdfFile.name + "\n(Analyzing...)";

                fetch('/upload/file/', {
                    method: 'POST',
                    headers: {
                        'X-CSRFToken': csrfToken
                    },
                    body: formData
                })
                    .then((response) => response.json())
                    .then((result) => {

                        result = JSON.parse(result);

                        if (result.status_code === 200) {
                            window.location.href = result.redirect_url + "&utm_source=LANDING_FILE_UPLOAD"
                        }
                        else {
                            alert(result.message)
                        }
                    })
                    .catch(error => console.error(error));
            }
        }

        // For file select
        function handleFileSelect(e) {
            e.preventDefault();
            if (1) {
                const csrfToken = document.getElementsByName('csrfmiddlewaretoken')[0].value;
                const fileInput = document.getElementById('pdf_file');
                const file = fileInput.files[0];
                const formData = new FormData();
                formData.append('csrfmiddlewaretoken', csrfToken);
                formData.append('pdf_file', file);
                formData.append('room_id', room_id);
                document.getElementById("upload-status").textContent = "File uploaded: " + file.name + "\n(Analyzing...)";

                fetch('/upload/file/', {
                    method: 'POST',
                    headers: {
                        'X-CSRFToken': csrfToken
                    },
                    body: formData
                })
                    .then((response) => response.json())
                    .then((result) => {

                        result = JSON.parse(result);

                        if (result.status_code === 200) {
                            window.location.href = result.redirect_url + "&utm_source=LANDING_FILE_UPLOAD"
                        }
                        else {
                            alert(result.message)
                        }
                    })
                    .catch(error => console.error(error));
            }
        }

        function readBookOnSelect(bookName) {
            if (bookName.getAttribute('data-bookname') != '') {
                bookName = bookName.getAttribute('data-bookname');
                window.location.href = "/chat?state=" + room_id + "&book=" + bookName + "&utm_source=LANDING_FILE_UPLOAD";
            }
            return false;
        }
    </script>
</body>

</html>